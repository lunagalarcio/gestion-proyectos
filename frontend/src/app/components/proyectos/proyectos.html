<div class="container mt-4">

  <!-- Formulario para crear proyecto -->
  <form [formGroup]="proyectoForm" (ngSubmit)="crearProyecto()" class="card p-4 shadow-sm mb-4">
    <h5>Crear nuevo proyecto</h5>

    <div class="row g-3">
      <div class="col-md-3">
        <label>Nombre del Proyecto:</label>
        <input type="text" class="form-control" formControlName="nombreproyecto" placeholder="Ej: Sistema de GestiÃ³n" />
      </div>

      <div class="col-md-3">
        <label>Fecha de inicio:</label>
        <input type="date" class="form-control" formControlName="fechainicio" />
      </div>

      <div class="col-md-3">
        <label>Fecha de fin:</label>
        <input type="date" class="form-control" formControlName="fechafin" />
      </div>

      <div class="col-md-3">
        <label for="clienteid">Cliente:</label>
        <select
          id="clienteid"
          class="form-select"
          formControlName="clienteid"
          required
        >
          <option value="" disabled selected>Selecciona un cliente</option>
          <option *ngFor="let cliente of clientes" [value]="cliente.clienteid">
            {{ cliente.nombre }}
          </option>
        </select>
      </div>
    </div>

    <div class="text-end mt-3">
      <button type="submit" class="btn btn-primary" [disabled]="proyectoForm.invalid">
        Crear Proyecto
      </button>
    </div>

  </form>

  <!-- Tabla de proyectos -->
  <div class="card p-3 shadow-sm">
    <h5 class="mb-3">Lista de proyectos</h5>

    <div *ngIf="cargando" class="text-center">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
    </div>

    <table class="table table-striped" *ngIf="!cargando && proyectos.length > 0">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Inicio</th>
          <th>Fin</th>
          <th>Cliente</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let proyecto of proyectos">
          <td>{{ proyecto.proyectoid }}</td>
          <td>{{ proyecto.nombreproyecto }}</td>
          <td>{{ proyecto.fechainicio | date }}</td>
          <td>{{ proyecto.fechafin | date }}</td>
          <td>{{ proyecto.cliente}}</td>
          <td>
            <button class="btn btn-danger btn-sm" (click)="eliminarProyecto(proyecto.proyectoid!)">
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <p *ngIf="!cargando && proyectos.length === 0" class="text-center text-muted">
      No hay proyectos registrados.
    </p>
  </div>
</div>
